<!DOCTYPE html>
<html lang="zh-cn"><head>
  <meta charset="utf-8">
  <title>Conv 2019</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description"
    content="疫情的数据R包运用">
  
  <meta name="author" content="北河沿">
  <meta name="generator" content="Hugo 0.64.1" />

    
  
<!-- highlight.js Stylesheet -->

  <link rel="stylesheet" href="https://stevechenzy.github.io/css/styles/monokai-sublime.css ">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  


  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://stevechenzy.github.io/scss/style.min.css" media="screen">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://stevechenzy.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://stevechenzy.github.io/plugins/themify-icons/themify-icons.css ">
  
  
  <!--Favicon-->
  <link rel="shortcut icon" href="https://stevechenzy.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://stevechenzy.github.io/images/favicon.png " type="image/x-icon">

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="fixed-top navigation mx-2">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-light bg-transparent">
      <a class="navbar-brand"href="https://stevechenzy.github.io/"><img class="img-fluid" src="https://stevechenzy.github.io/images/beiheyan-small.svg" alt="北河沿"></a>

      
        

    

        <!-- search -->
        <div class="search">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://stevechenzy.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="输入搜索关键词 & 回车...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation --> <div class="py-2 d-none d-lg-block"></div> 

<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto block shadow 0">
        <h4>Conv 2019</h4>
        <div class="mb-3 post-meta">
          <a href="https://stevechenzy.github.io/author/%e5%8c%97%e6%b2%b3%e6%b2%bf">北河沿</a>,
          2020-03-07, 
          <a href="https://stevechenzy.github.io/categories/r">R</a>
          

        </div>
        
        <div class="content mb-0">
          
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>稍微读了一下源代码，理解了语言是如何影响到数据的。还是中文的更好。</p>
<p>先做一些准备工作，下载remotes这个包</p>
<pre class="r"><code># prepare for remote 
# install.packages(&quot;remotes&quot;)
# library(remotes)</code></pre>
<p>用remotes安装GuangchuangYu发布在github上的R包：nCov2019</p>
<pre class="r"><code># install the package
# remotes::install_github(&quot;/nCov2019&quot;)
# library(nCov2019)</code></pre>
<p>显示一些数据结构</p>
<pre class="r"><code># load latest data
Sys.setlocale(&quot;LC_ALL&quot;, locale=&quot;zh_CN.UTF-8&quot;)</code></pre>
<pre><code>## [1] &quot;zh_CN.UTF-8/zh_CN.UTF-8/zh_CN.UTF-8/C/zh_CN.UTF-8/en_US.UTF-8&quot;</code></pre>
<pre class="r"><code>library(nCov2019)
library(tidyverse)</code></pre>
<pre><code>## ─ Attaching packages ─────────────────────────── tidyverse 1.3.0 ─</code></pre>
<pre><code>## ✓ ggplot2 3.3.0     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.4
## ✓ tidyr   1.0.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0</code></pre>
<pre><code>## ─ Conflicts ───────────────────────────── tidyverse_conflicts() ─
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>x &lt;- get_nCov2019(lang = &quot;zh&quot;)

# show the total number
x</code></pre>
<pre><code>## China (total confirmed cases): 80859
## last update: 2020-03-08 15:31:30</code></pre>
<pre class="r"><code># updated time
time(x)</code></pre>
<pre><code>## [1] &quot;2020-03-08 15:31:30&quot;</code></pre>
<pre class="r"><code># open browser 
# open(x)

# list different provinces
#Sys.setlocale(&quot;LC_ALL&quot;, locale=&quot;zh_CN.UTF-8&quot;)
# library(nCov2019)
# x &lt;- get_nCov2019()
x[]</code></pre>
<pre><code>##      name confirm suspect dead deadRate showRate  heal healRate showHeal
## 1    湖北   67707       0 2986     4.41    FALSE 45011    66.48     TRUE
## 2    广东    1352       0    7     0.52    FALSE  1250    92.46     TRUE
## 3    河南    1272       0   22     1.73    FALSE  1246    97.96     TRUE
## 4    浙江    1215       0    1     0.08    FALSE  1169    96.21     TRUE
## 5    湖南    1018       0    4     0.39    FALSE   965    94.79     TRUE
## 6    安徽     990       0    6     0.61    FALSE   984    99.39     TRUE
## 7    江西     935       0    1     0.11    FALSE   918    98.18     TRUE
## 8    山东     758       0    6     0.79    FALSE   638    84.17     TRUE
## 9    江苏     631       0    0     0.00    FALSE   610    96.67     TRUE
## 10   重庆     576       0    6     1.04    FALSE   526    91.32     TRUE
## 11   四川     539       0    3     0.56    FALSE   457    84.79     TRUE
## 12 黑龙江     481       0   13     2.70    FALSE   409    85.03     TRUE
## 13   北京     428       0    8     1.87    FALSE   308    71.96     TRUE
## 14   上海     342       0    3     0.88    FALSE   314    91.81     TRUE
## 15   河北     318       0    6     1.89    FALSE   307    96.54     TRUE
## 16   福建     296       0    1     0.34    FALSE   295    99.66     TRUE
## 17   广西     252       0    2     0.79    FALSE   223    88.49     TRUE
## 18   陕西     245       0    1     0.41    FALSE   226    92.24     TRUE
## 19   云南     174       0    2     1.15    FALSE   170    97.70     TRUE
## 20   海南     168       0    6     3.57    FALSE   158    94.05     TRUE
## 21   贵州     146       0    2     1.37    FALSE   117    80.14     TRUE
## 22   天津     136       0    3     2.21    FALSE   128    94.12     TRUE
## 23   山西     133       0    0     0.00    FALSE   126    94.74     TRUE
## 24   辽宁     125       0    1     0.80    FALSE   108    86.40     TRUE
## 25   甘肃     120       0    2     1.67    FALSE    87    72.50     TRUE
## 26   香港     109       0    2     1.83    FALSE    55    50.46     TRUE
## 27   吉林      93       0    1     1.08    FALSE    90    96.77     TRUE
## 28   新疆      76       0    3     3.95    FALSE    72    94.74     TRUE
## 29   宁夏      75       0    0     0.00    FALSE    71    94.67     TRUE
## 30 内蒙古      75       0    1     1.33    FALSE    68    90.67     TRUE
## 31   台湾      45       0    1     2.22    FALSE    13    28.89     TRUE
## 32   青海      18       0    0     0.00    FALSE    18   100.00     TRUE
## 33   澳门      10       0    0     0.00    FALSE    10   100.00     TRUE
## 34   西藏       1       0    0     0.00    FALSE     1   100.00     TRUE</code></pre>
<pre class="r"><code>#
# library(nCov2019)
# x &lt;- get_nCov2019()
x[&quot;湖北&quot;]</code></pre>
<pre><code>##      name confirm suspect dead deadRate showRate  heal healRate showHeal
## 1    武汉   49912       0 2370     4.75    FALSE 29770    59.64     TRUE
## 2    孝感    3518       0  125     3.55    FALSE  3024    85.96     TRUE
## 3    黄冈    2907       0  125     4.30    FALSE  2627    90.37     TRUE
## 4    荆州    1580       0   49     3.10    FALSE  1376    87.09     TRUE
## 5    鄂州    1394       0   54     3.87    FALSE   988    70.88     TRUE
## 6    随州    1307       0   43     3.29    FALSE  1077    82.40     TRUE
## 7    襄阳    1175       0   38     3.23    FALSE  1055    89.79     TRUE
## 8    黄石    1015       0   36     3.55    FALSE   884    87.09     TRUE
## 9    宜昌     931       0   34     3.65    FALSE   727    78.09     TRUE
## 10   荆门     928       0   39     4.20    FALSE   743    80.06     TRUE
## 11   咸宁     836       0   14     1.67    FALSE   801    95.81     TRUE
## 12   十堰     672       0    8     1.19    FALSE   571    84.97     TRUE
## 13   仙桃     575       0   21     3.65    FALSE   501    87.13     TRUE
## 14   天门     496       0   15     3.02    FALSE   457    92.14     TRUE
## 15 恩施州     252       0    6     2.38    FALSE   231    91.67     TRUE
## 16   潜江     198       0    9     4.55    FALSE   168    84.85     TRUE
## 17 神农架      11       0    0     0.00    FALSE    11   100.00     TRUE</code></pre>
<pre class="r"><code>#library(nCov2019)
# library(ggplot2)
#x &lt;- get_nCov2019()
b &lt;- x[&#39;北京&#39;]
b</code></pre>
<pre><code>##          name confirm suspect dead deadRate showRate heal healRate showHeal
## 1        朝阳      72       0    0     0.00    FALSE    0     0.00    FALSE
## 2        海淀      63       0    0     0.00    FALSE    0     0.00    FALSE
## 3        西城      53       0    0     0.00    FALSE    0     0.00    FALSE
## 4        丰台      43       0    0     0.00    FALSE    0     0.00    FALSE
## 5        大兴      39       0    0     0.00    FALSE    0     0.00    FALSE
## 6        昌平      29       0    0     0.00    FALSE    0     0.00    FALSE
## 7    外地来京      25       0    0     0.00    FALSE    0     0.00    FALSE
## 8        通州      19       0    0     0.00    FALSE    0     0.00    FALSE
## 9        房山      16       0    0     0.00    FALSE    0     0.00    FALSE
## 10     石景山      14       0    0     0.00    FALSE    0     0.00    FALSE
## 11       东城      14       0    0     0.00    FALSE    0     0.00    FALSE
## 12   境外输入      13       0    0     0.00    FALSE    0     0.00     TRUE
## 13       顺义      10       0    0     0.00    FALSE    0     0.00    FALSE
## 14       密云       7       0    0     0.00    FALSE    0     0.00    FALSE
## 15       怀柔       7       0    0     0.00    FALSE    0     0.00    FALSE
## 16     门头沟       3       0    0     0.00    FALSE    0     0.00    FALSE
## 17       延庆       1       0    0     0.00    FALSE    0     0.00    FALSE
## 18 地区待确认       0       0    8     0.00    FALSE  308     0.00     TRUE</code></pre>
<pre class="r"><code>ggplot(b, aes(name, confirm)) + 
  geom_bar(stat = &quot;identity&quot;, fill = &quot;pink&quot;) + 
  xlab(&quot;城区(来源）&quot;) + 
  ylab(&quot;确诊人数&quot;) +
  theme_classic()+
  theme(axis.text.x = element_text(angle = -90, vjust = 0.5, hjust = 0.0)) +
  theme(text = element_text(family = &quot;STHeiti&quot;))   </code></pre>
<p><img src="/r/ggplot2/conv-2019_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># must be the last one to be sure the right font is oused. </code></pre>
<pre class="r"><code># newly 
# library(tidyverse)
# library(nCov2019)
# x &lt;- get_nCov2019()

d = x[&#39;global&#39;,] %&gt;% filter(name != &#39;中国&#39;)
d$confirm=as.numeric(d$confirm)

d$name = fct_reorder(d$name, d$confirm)

ggplot(d, aes(name, confirm)) +
  geom_col(fill=&#39;orange&#39;, width = 0.8) + 
  coord_flip() +
  geom_text(aes(y = confirm+2, label=confirm),size=2, hjust=0) +
  theme_minimal(base_size=10) +
 
  xlab(NULL) + ylab(NULL)+
theme(text = element_text(family = &quot;STHeiti&quot;)) </code></pre>
<p><img src="/r/ggplot2/conv-2019_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># another plot
# library(nCov2019)
# library(ggplot2)
# x &lt;- get_nCov2019()
ggplot(summary(x), aes(as.Date(date, &quot;%m.%d&quot;), as.numeric(confirm))) +
  geom_col(fill=&#39;firebrick&#39;) + theme_minimal(base_size = 14) +
  xlab(NULL) + ylab(NULL) +
  labs(caption = paste(&quot;更新时间:&quot;, time(x))) +
  theme(text = element_text(family = &quot;STHeiti&quot;)) </code></pre>
<p><img src="/r/ggplot2/conv-2019_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>

        </div>
      </div>
    </div>
  </div>
</section>


<footer class="py-0 bg-light border-top-0">
  <div class="container">
    <div class="text-center mt-1">
      <span>© 北河沿 北京 2020 </span>
    </div>
  </div>
 

</footer>




<script>
  var indexURL = "https://stevechenzy.github.io/index.json"
</script>


<!-- JS Plugins -->

<script src="https://stevechenzy.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://stevechenzy.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://stevechenzy.github.io/plugins/search/fuse.min.js"></script>

<script src="https://stevechenzy.github.io/plugins/search/mark.js"></script>

<script src="https://stevechenzy.github.io/plugins/search/search.js"></script>


<!-- Main Script -->

<script src="https://stevechenzy.github.io/js/script.min.js"></script>
</body>

</html>